<!DOCTYPE html>  
<html lang="ar" dir="rtl">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">  
    <title>Ø®Ø²Ù†Ø© Ø£Ø³Ø±Ø§Ø±ÙŠ - Cloud Pro</title>  
    
    <!-- Ù…ÙƒØªØ¨Ø© Ø¬ÙˆØ¬Ù„ -->
    <script src="https://accounts.google.com/gsi/client" onload="initGoogleLib()" async defer></script>

    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&family=Amiri:wght@700&display=swap" rel="stylesheet">  
    <style>  
        :root {  
            --bg-color: #f8fafc;  
            --primary-color: #6366f1; /* Ù„ÙˆÙ† Ù‚Ø±ÙŠØ¨ Ù„Ù„ØµÙˆØ±Ø© (Ø¨Ù†ÙØ³Ø¬ÙŠ/Ø£Ø²Ø±Ù‚) */
            --primary-dark: #4f46e5;
            --folder-color: #f59e0b; 
            --secondary-color: #8b5cf6;   
            --success-color: #10b981;  
            --danger-color: #ef4444;   
            --card-color: #ffffff;  
            --text-color: #1e293b;  
            --text-secondary: #64748b;  
            --light-bg: #f1f5f9;  
            --border-color: #e2e8f0;   
            --selection-color: #10b981;  
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);  
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);  
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); 
            --radius: 20px;
        }  

        * {  
            -webkit-tap-highlight-color: transparent;   
            box-sizing: border-box;  
            outline: none;  
        }  

        body {  
            font-family: 'Tajawal', sans-serif;  
            background-color: var(--bg-color);  
            background-image: radial-gradient(#e0e7ff 1px, transparent 1px);  
            background-size: 24px 24px;  
            margin: 0;  
            padding: 20px;  
            color: var(--text-color);  
            padding-bottom: 120px;   
            -webkit-user-select: none; user-select: none;           
        }  
          
        input, textarea {  
            -webkit-user-select: text !important; user-select: text !important;  
        }  

        /* --- Header --- */  
        .header-content {  
            position: relative; text-align: center; margin-bottom: 25px; padding-top: 40px;  
        }  

        h1 {  
            color: var(--primary-color); font-weight: 800; margin: 0 0 5px 0; font-size: 2.2rem;  
        }  
        
        #navBar {
            display: none; align-items: center; justify-content: flex-start; margin-bottom: 15px;
            background: white; padding: 10px 15px; border-radius: 12px; box-shadow: var(--shadow-sm);
        }
        .back-btn {
            background: var(--light-bg); border: none; padding: 8px 12px; border-radius: 8px;
            cursor: pointer; font-weight: bold; color: var(--primary-color);
            display: flex; align-items: center; gap: 5px;
        }

        .settings-btn {  
            position: absolute; top: 10px; left: 10px; width: 45px; height: 45px; 
            background: white; border-radius: 50%; box-shadow: var(--shadow-sm);
            display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 2000;
            font-size: 1.5rem; color: var(--text-color);
        }  

        .cloud-status {
            position: absolute; top: 20px; left: 70px; font-size: 0.8rem;
            color: var(--text-secondary); display: flex; align-items: center; gap: 5px;
        }

        /* --- Search --- */
        .search-container { margin-bottom: 25px; position: relative; }  
        #searchInput, #subSearchInput {  
            width: 100%; padding: 16px 20px; padding-left: 45px; 
            border: 2px solid transparent; background-color: white; border-radius: var(--radius);  
            font-family: 'Tajawal', sans-serif; font-size: 1.1rem;  
            text-align: right; box-shadow: var(--shadow-md); transition: all 0.3s ease;  
        }
        #searchInput:focus, #subSearchInput:focus {  
            border-color: var(--primary-color); box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.15);
        }
        .clear-search-btn {
            position: absolute; left: 10px; top: 50%; transform: translateY(-50%);
            width: 30px; height: 30px; background-color: #e2e8f0; color: #64748b;
            border-radius: 50%; display: none; align-items: center; justify-content: center;
            font-weight: bold; cursor: pointer; z-index: 10;
        }

        /* --- Cards Grid --- */  
        .grid-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; padding-bottom: 20px; align-items: start; }  
        .note-card {  
            background-color: var(--card-color); border-radius: 20px; padding: 15px 10px; height: 160px;      
            display: flex; flex-direction: column; justify-content: space-between; align-items: center;  
            box-shadow: var(--shadow-md); cursor: pointer; border-bottom: 6px solid var(--primary-color); position: relative;  
            text-align: center; touch-action: pan-y;
        }  
        .note-card.is-folder { background-color: #fffbeb; border-bottom-color: var(--folder-color) !important; border-radius: 20px 20px 0 0; }
        .note-card.drag-target { border: 3px dashed var(--primary-color) !important; background-color: #e0e7ff !important; transform: scale(1.05); }
        .note-card:hover { transform: translateY(-5px); box-shadow: var(--shadow-lg); }  
        .note-card.dragging { opacity: 0.5; transform: scale(0.95); }
        .note-card.selected { border: 3px solid var(--selection-color); background-color: #f0fdf4; transform: scale(0.98); }  
        .card-icon-big { font-size: 2.2rem; margin-bottom: 5px; margin-top: 5px; }
        .card-title {  
            font-size: 0.95rem; font-weight: 700; margin-bottom: 5px; line-height: 1.4; color: var(--text-color);  
            width: 100%; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; 
        }  
        .card-count { background: var(--light-bg); padding: 2px 10px; border-radius: 20px; font-size: 0.75rem !important; color: var(--text-secondary) !important; font-weight: 600; }  
        
        /* --- FAB --- */  
        .fab {  
            position: fixed; bottom: 30px; left: 30px; width: 60px; height: 60px; border-radius: 20px; 
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));   
            color: white; font-size: 2.5rem; line-height: 60px; text-align: center; border: none; 
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4); cursor: pointer; z-index: 1000; 
        }  

        /* --- STYLED MENUS (Like Screenshot) --- */
        .styled-menu {
            position: fixed; background-color: white; border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2); z-index: 5000; display: none;
            flex-direction: column; overflow: hidden; width: 280px; max-width: 90%;
            animation: menuPopup 0.2s cubic-bezier(0.18, 0.89, 0.32, 1.28) forwards;
            padding: 8px 0;
        }
        
        /* Modal Version of Menu (Settings) */
        .modal-menu-container {
            width: 100%; max-width: 320px; background: white; border-radius: 20px;
            padding: 10px 0; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
            animation: slideUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .menu-item {
            display: flex; align-items: center; justify-content: space-between;
            padding: 16px 20px; background: white; border: none; border-bottom: 1px solid #f1f5f9;
            width: 100%; cursor: pointer; transition: background 0.2s;
            font-family: 'Tajawal', sans-serif; font-size: 1rem; color: #334155; font-weight: 600;
            text-align: right;
        }
        .menu-item:last-child { border-bottom: none; }
        .menu-item:hover { background-color: #f8fafc; color: var(--primary-color); }
        .menu-item.danger { color: var(--danger-color); }
        .menu-item.danger .menu-icon svg { stroke: var(--danger-color); }
        
        /* Icon styling to match screenshot (Left side) */
        .menu-icon {
            display: flex; align-items: center; justify-content: center;
            color: #64748b; margin-right: 15px; /* RTL flip means this pushes text away if order is natural */
        }
        /* Override flex order to match screenshot: Text Right, Icon Left */
        .menu-item { flex-direction: row-reverse; } 
        .menu-icon { margin-right: 0; margin-left: 0; } /* Reset */
        
        .menu-icon svg { width: 22px; height: 22px; stroke-width: 1.8; stroke: currentColor; fill: none; stroke-linecap: round; stroke-linejoin: round; }

        @keyframes menuPopup { from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); } to { opacity: 1; transform: translate(-50%, -50%) scale(1); } }  
        @keyframes slideUp { from { opacity: 0; transform: translateY(100%); } to { opacity: 1; transform: translateY(0); } }  

        /* --- Modals --- */
        .modal {  
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.4); z-index: 3000; justify-content: center; align-items: center; backdrop-filter: blur(3px); 
        }  
        .modal-content {  
            background-color: white; width: 100%; height: 100%; padding: 25px; display: flex; flex-direction: column;  
        }
        .small-modal-content { 
            height: auto !important; width: 90% !important; max-width: 320px !important; 
            text-align: center; padding: 25px; border-radius: 24px; background: white;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }  
        
        /* --- Inputs & Textareas in Modal --- */
        .modal-input-area {  
            width: 100%; flex-grow: 1; padding: 15px; border: 2px solid var(--primary-color); border-radius: 12px; font-family: 'Tajawal'; font-size: 1.2rem; text-align: right; margin-bottom: 20px;  
            background-color: #fdfdfd; resize: none; overflow-y: auto; white-space: pre-wrap; line-height: 1.6;
        }
        .modal-input-single { width: 100%; padding: 15px; border: 2px solid var(--border-color); border-radius: 12px; font-family: 'Tajawal'; font-size: 1.1rem; text-align: right; margin-bottom: 20px; background-color: #f8fafc; }
        
        /* --- Buttons --- */
        .modal-actions { display: flex; justify-content: center; gap: 10px; margin-top: 10px; }  
        .modal-btn { 
            border: none; padding: 12px 20px; border-radius: 12px; cursor: pointer; 
            font-weight: 700; font-family: 'Tajawal'; font-size: 1rem; flex: 1; 
        }  
        .modal-btn.confirm-primary { background: var(--primary-color); color: white; }  
        .modal-btn.cancel { background-color: var(--light-bg); color: var(--text-secondary); }  
        
        .sub-notes-list { flex-grow: 1; overflow-y: auto; list-style: none; padding: 5px; margin: 0; padding-bottom: 10px; }  
        .sub-note-item { display: flex; align-items: flex-start; justify-content: space-between; background-color: white; padding: 15px; margin-bottom: 12px; border-radius: 12px; box-shadow: var(--shadow-sm); border-right: 4px solid var(--secondary-color); cursor: pointer; }  
        .input-area { display: flex; gap: 10px; margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--border-color); }  
        #newSubNoteInput { flex-grow: 1; height: 50px; padding: 12px; border: 2px solid var(--border-color); border-radius: 14px; font-family: 'Tajawal'; text-align: right; }  
        .add-btn { background: var(--primary-color); color: white; border: none; border-radius: 14px; width: 50px; height: 50px; font-size: 1.5rem; cursor: pointer; }  

        /* --- Google Login Overlay --- */
        #loginOverlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background-color: #f0f2f5; z-index: 6000; display: none; flex-direction: column;
            align-items: center; justify-content: center; padding: 20px;
        }
        .google-btn {
            display: flex; align-items: center; justify-content: center; width: 100%; max-width: 300px;
            background-color: #1a73e8; color: white; border: none; padding: 2px; border-radius: 4px; 
            font-size: 14px; font-weight: 500; cursor: pointer; font-family: 'Segoe UI', sans-serif;
        }
        .google-icon-wrapper { background: white; padding: 8px; border-radius: 2px; margin: 1px; display: flex; align-items: center; justify-content: center; height: 38px; width: 38px; }
        .google-icon { width: 18px; height: 18px; }
        .btn-text { flex: 1; text-align: center; }
        .sync-loader {
            display: none; width: 16px; height: 16px; border: 2px solid #ddd;
            border-top: 2px solid var(--primary-color); border-radius: 50%;
            animation: spin 0.8s linear infinite; margin-left: 10px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    </style>  
</head>  
<body>  

<!-- Google Login Screen -->
<div id="loginOverlay">
    <div style="background: white; padding: 40px; border-radius: 16px; text-align: center; width: 100%; max-width: 350px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
        <img src="https://upload.wikimedia.org/wikipedia/commons/2/2f/Google_2015_logo.svg" alt="Google" style="width: 80px; margin-bottom: 20px;">
        <h2 style="font-size:20px; margin:0 0 10px 0;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
        <p style="color:#64748b; margin-bottom:30px; font-size: 0.9rem;">Ù„Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø³Ø­Ø§Ø¨ÙŠØ§Ù‹ ÙˆÙ…Ù†Ø¹ Ø¶ÙŠØ§Ø¹Ù‡Ø§.</p>
        <a href="#" class="google-btn" onclick="event.preventDefault(); startGoogleLogin()">
            <div class="google-icon-wrapper"><img class="google-icon" src="https://upload.wikimedia.org/wikipedia/commons/c/c1/Google_%22G%22_logo.svg"/></div>
            <span class="btn-text">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Google</span>
        </a>
    </div>
</div>

<div class="header-content">  
    <span class="settings-btn" onclick="handleSettingsOpen()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></svg>
    </span>
    <div class="cloud-status">
        <div id="syncLoader" class="sync-loader"></div>
        <span id="syncText"></span>
    </div>

    <h1>Ø®Ø²Ù†Ø© Ø£Ø³Ø±Ø§Ø±ÙŠ</h1>  
    <p class="author-name" style="margin:0; color: #64748b; font-size: 1rem;">Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©</p>  
</div>  

<div id="navBar">
    <button class="back-btn" onclick="window.history.back()">âœ Ø±Ø¬ÙˆØ¹</button>
    <span id="currentPathTitle" style="margin-right: 10px; font-weight: 700; color: #64748b;"></span>
</div>

<div class="search-container">  
    <span id="clearSearchBtn" class="clear-search-btn" onclick="clearSearch()">Ã—</span>
    <input type="text" id="searchInput" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª..." oninput="searchNotes()" autocomplete="off">  
</div>  

<!-- MAIN CONTEXT MENU (Styled like Settings) -->
<div id="contextMenu" class="styled-menu" style="width: 250px;">  
    <div class="menu-item" onclick="handleMenuAction('toggleLock')">
        <span>Ù‚ÙÙ„ / Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù‚ÙÙ„</span>
        <div class="menu-icon"><svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg></div>
    </div>
    <div class="menu-item" onclick="handleMenuAction('edit')">
        <span>ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…</span>
        <div class="menu-icon"><svg viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></div>
    </div>
    <div class="menu-item" onclick="handleMenuAction('copyText')">
        <span>Ù†Ø³Ø® Ø§Ù„Ù…Ø­ØªÙˆÙ‰</span>
        <div class="menu-icon"><svg viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></div>
    </div>
    <div class="menu-item danger" onclick="handleMenuAction('delete')">
        <span>Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ</span>
        <div class="menu-icon"><svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg></div>
    </div>
</div>  

<div id="notesGrid" class="grid-container"></div>  

<button class="fab" onclick="showCreateMenu()">+</button> 

<!-- Create Type Menu -->
<div id="createTypeMenu" class="styled-menu" style="bottom: 100px; left: 30px; top: auto; width: 180px;">
    <div class="menu-item" onclick="createItemWrapper('folder')">
        <span>Ù…Ø¬Ù„Ø¯ Ø¬Ø¯ÙŠØ¯</span>
        <div class="menu-icon"><svg viewBox="0 0 24 24"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg></div>
    </div>
    <div class="menu-item" onclick="createItemWrapper('note')">
        <span>Ù…Ù„Ø§Ø­Ø¸Ø© Ø¬Ø¯ÙŠØ¯Ø©</span>
        <div class="menu-icon"><svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg></div>
    </div>
</div>

<!-- Details Modal -->
<div id="detailsModal" class="modal">  
    <div class="modal-content">  
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">  
            <button class="back-btn" onclick="window.history.back()">âœ Ø±Ø¬ÙˆØ¹</button>
            <span id="modalTitle" style="font-weight: 800; font-size: 1.2rem; color: var(--primary-color);"></span>  
        </div>  
        <input type="text" id="subSearchInput" placeholder="Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©..." oninput="renderSubNotes()" autocomplete="off">
        <ul id="subNotesList" class="sub-notes-list" style="margin-top:10px;"></ul>  
        <div class="input-area">  
            <textarea id="newSubNoteInput" placeholder="Ø£Ø¶Ù Ù†ØµØ§Ù‹..."></textarea>   
            <button class="add-btn" onclick="addSubNote()">+</button> 
        </div>  
    </div>  
</div>  

<!-- Input Modal -->
<div id="inputModal" class="modal">  
    <div class="modal-content">  
        <p id="inputMessage" class="modal-message" style="text-align:center; font-weight:bold;"></p>  
        <input type="text" id="modalInputSingle" class="modal-input-single" style="display:none;" autocomplete="off">
        <textarea id="modalInputArea" class="modal-input-area" style="display:none;" spellcheck="false" autocomplete="off"></textarea>
        <div class="modal-actions">  
            <button id="inputBtn" class="modal-btn confirm-primary">Ø­ÙØ¸</button>  
            <button class="modal-btn cancel" onclick="window.history.back()">Ø¥Ù„ØºØ§Ø¡</button>  
        </div>  
    </div>  
</div>  
  
<!-- SETTINGS MODAL (New Design) -->
<div id="settingsModal" class="modal" onclick="if(event.target.id === 'settingsModal') hideSettingsModal()">  
    <!-- Inner Container for the Menu -->
    <div class="modal-menu-container">
        <!-- Header inside Menu -->
        <h3 style="text-align: center; margin: 10px 0 20px 0; color: var(--primary-color);">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h3>

        <!-- Google Login -->
        <div id="googleLoginItem" class="menu-item" onclick="openLoginOverlay()">
            <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Google)</span>
            <div class="menu-icon"><svg viewBox="0 0 24 24"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path></svg></div>
        </div>
        
        <!-- Google Logout (Dynamic) -->
        <div id="googleLogoutItem" class="menu-item" onclick="handleGoogleLogout()" style="display:none;">
            <span>ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ (Google)</span>
            <div class="menu-icon"><svg viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg></div>
        </div>

        <!-- App Lock -->
        <div class="menu-item" onclick="setAppPassword()">
            <span id="lockText">Ù‚ÙÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±)</span>
            <div class="menu-icon"><svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg></div>
        </div>

        <!-- Manual Backup (Code) -->
        <div class="menu-item" onclick="exportDataManual()">
            <span>Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ (ÙƒÙˆØ¯)</span>
            <div class="menu-icon"><svg viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></div>
        </div>

        <!-- Export JSON -->
        <div class="menu-item" onclick="exportDataAuto()">
            <span>ØªÙ†Ø²ÙŠÙ„ Ù†Ø³Ø®Ø© Ù…Ù„Ù (JSON)</span>
            <div class="menu-icon"><svg viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></div>
        </div>

        <!-- Import Manual (Code) -->
        <div class="menu-item" onclick="importDataPaste()">
            <span>Ø§Ø³ØªÙŠØ±Ø§Ø¯ (ÙƒÙˆØ¯)</span>
            <div class="menu-icon"><svg viewBox="0 0 24 24"><polyline points="9 11 12 14 22 4"></polyline><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg></div>
        </div>

        <!-- Import JSON -->
        <div class="menu-item" onclick="document.getElementById('importFile').click()">
            <span>Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù„Ù (JSON)</span>
            <div class="menu-icon"><svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg></div>
        </div>
        <input type="file" id="importFile" accept=".json" style="display:none;" onchange="importDataWrapper(event)">

        <!-- Delete All -->
        <div class="menu-item danger" onclick="deleteAllData()">
            <span>Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
            <div class="menu-icon"><svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg></div>
        </div>
    </div>  
</div>  

<div id="confirmModal" class="modal">  
    <div class="modal-content small-modal-content">  
        <p id="confirmMessage" class="modal-message"></p>  
        <div class="modal-actions">  
            <button class="modal-btn cancel" onclick="hideConfirmModal(false)">Ø¥Ù„ØºØ§Ø¡</button>  
            <button class="modal-btn confirm-primary" style="background: var(--danger-color);" onclick="hideConfirmModal(true)">ØªØ£ÙƒÙŠØ¯</button>  
        </div>  
    </div>  
</div>

<div id="passwordModal" class="modal">  
    <div class="modal-content small-modal-content">  
        <p class="modal-message">Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</p>  
        <input type="password" id="modalPasswordInput" class="modal-input-single" placeholder="â€¢â€¢â€¢â€¢" style="text-align:center;">
        <div class="modal-actions">  
            <button class="modal-btn cancel" onclick="hidePasswordModal(null)">Ø¥Ù„ØºØ§Ø¡</button>  
            <button id="passwordBtn" class="modal-btn confirm-primary">ØªØ£ÙƒÙŠØ¯</button>  
        </div>  
    </div>  
</div>

<div id="notificationModal" class="modal" onclick="closeNotification()">  
    <div class="modal-content small-modal-content">  
        <span id="notifIcon" style="font-size: 2rem; display:block; margin-bottom:10px;">â„¹ï¸</span>
        <p id="notificationMessage" class="modal-message"></p>  
        <button class="modal-btn confirm-primary" onclick="closeNotification()">Ø­Ø³Ù†Ø§Ù‹</button>  
    </div>  
</div>

<script>  
    const APP_PASS_KEY = 'smartNotes_appPass';
    let allData = [];   
    let currentFolderId = null; 
    let currentNoteId = null;
    
    // Google API Config
    const GOOGLE_CLIENT_ID = '979816526016-ukb9vqtb6u2hlutombpf8rumbjr3o2ua.apps.googleusercontent.com';
    const SCOPES = 'https://www.googleapis.com/auth/drive.appdata';
    const FILENAME = 'smart_notes_cloud_v1.json'; 
    let tokenClient;
    let gAccessToken = localStorage.getItem('gAccessToken'); 
    let saveTimeout = null; 

    // History Handling
    window.addEventListener('popstate', function(event) {
        if (document.getElementById('inputModal').style.display === 'flex') hideInputModal(false);
        else if (document.getElementById('detailsModal').style.display === 'flex') closeModalInternal();
        else if (document.getElementById('searchInput').value !== '') clearSearch();
        else if (currentFolderId !== null) { currentFolderId = null; renderMainGrid(); }
    });

    function pushState() { window.history.pushState({ open: true }, ""); }
    function findNoteById(list, id) { id = parseInt(id); for (let item of list) { if (parseInt(item.id) === id) return item; if (item.type === 'folder' && item.items) { const found = findNoteById(item.items, id); if (found) return found; } } return null; }
    function getCurrentList() { if (currentFolderId === null) return allData; const folder = findNoteById(allData, currentFolderId); return folder ? folder.items : []; }
    
    // Core Functions
    function saveData() { 
        if(saveTimeout) clearTimeout(saveTimeout);
        document.getElementById('syncText').innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...";
        setSyncLoader(true);
        saveTimeout = setTimeout(() => { forceUploadToDrive(true); }, 1000);
    } 
    
    function loadData() { 
        allData = []; 
        if(gAccessToken) { forceSyncFromCloud(true); } 
        else { document.getElementById('loginOverlay').style.display = 'flex'; }
    }

    let activeCardId = null; 
    document.addEventListener('DOMContentLoaded', () => { 
        document.getElementById('searchInput').value = '';
        loadData(); 
        renderMainGrid(); 
    });

    // Grid Rendering
    function renderMainGrid(filter = '') {
        const grid = document.getElementById('notesGrid'); grid.innerHTML = ''; 
        const navBar = document.getElementById('navBar');
        if (currentFolderId === null) { navBar.style.display = 'none'; } 
        else { navBar.style.display = 'flex'; const folder = findNoteById(allData, currentFolderId); document.getElementById('currentPathTitle').innerText = folder ? `ğŸ“ ${folder.title}` : ''; }
        
        const list = getCurrentList(); const filteredList = list.filter(n => n.title.toLowerCase().includes(filter.toLowerCase()));
        
        if (!gAccessToken) { grid.innerHTML = '<p style="grid-column:1/-1; text-align:center; color:#ef4444;">Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.</p>'; return; }
        if (filteredList.length === 0) { grid.innerHTML = '<p style="grid-column:1/-1; text-align:center; color:#94a3b8; margin-top:50px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ±.</p>'; }
        
        filteredList.forEach(item => {
            const card = document.createElement('div'); card.className = `note-card ${item.type === 'folder' ? 'is-folder' : ''}`;
            let icon = item.type === 'folder' ? 'ğŸ“' : 'ğŸ“„'; if (item.isLocked) icon = 'ğŸ”’';
            const count = item.items.length; 
            
            card.innerHTML = ` <div class="card-icon-big">${icon}</div> <div class="card-title">${item.title}</div> <div class="card-count">${count} Ø¹Ù†ØµØ±</div> `;
            
            // Interaction: Click vs Long Press
            let isLongPress = false; let pressTimer;
            
            card.onclick = (e) => { if(!isLongPress) handleCardClick(e, item); }; 
            
            card.addEventListener('touchstart', (e) => { 
                isLongPress = false; 
                pressTimer = setTimeout(() => { 
                    isLongPress = true; 
                    if(navigator.vibrate) navigator.vibrate(50);
                    showContextMenu(item.id); 
                }, 600); 
            });
            card.addEventListener('touchend', () => clearTimeout(pressTimer)); 
            card.addEventListener('touchmove', () => clearTimeout(pressTimer));
            card.oncontextmenu = (e) => { e.preventDefault(); isLongPress = true; showContextMenu(item.id); };

            grid.appendChild(card);
        });
        const clearBtn = document.getElementById('clearSearchBtn'); clearBtn.style.display = filter.length > 0 ? 'flex' : 'none';
    }
    
    function searchNotes() { renderMainGrid(document.getElementById('searchInput').value); }
    function clearSearch() { document.getElementById('searchInput').value = ''; renderMainGrid(); }
    
    // Actions
    function handleCardClick(e, item) { 
        if (item.type === 'folder') { 
            if (item.isLocked) { checkPassword(item, () => { currentFolderId = item.id; pushState(); renderMainGrid(); }); } 
            else { currentFolderId = item.id; pushState(); renderMainGrid(); } 
        } else { 
            currentNoteId = item.id;
            if (item.isLocked) { checkPassword(item, () => { openNoteDetails(item); }); } 
            else { openNoteDetails(item); } 
        } 
    }

    function openNoteDetails(note) {
        document.getElementById('modalTitle').innerText = note.title; 
        document.getElementById('detailsModal').style.display = 'flex'; 
        pushState(); renderSubNotes();
    }

    function renderSubNotes() {
        const listEl = document.getElementById('subNotesList'); listEl.innerHTML = ''; 
        const note = findNoteById(allData, currentNoteId); if (!note) return; 
        const filter = document.getElementById('subSearchInput').value.toLowerCase();
        
        note.items.forEach((content, index) => {
            if (filter && !content.toLowerCase().includes(filter)) return;
            const li = document.createElement('li'); li.className = 'sub-note-item';
            li.innerHTML = `<div style="flex:1; line-height:1.5;">${content}</div>`; 
            
            // Delete sub-note button
            const delBtn = document.createElement('span');
            delBtn.innerHTML = 'ğŸ—‘ï¸'; delBtn.style.cursor='pointer'; delBtn.style.padding='5px';
            delBtn.onclick = (e) => { e.stopPropagation(); deleteSubNote(index); };
            li.appendChild(delBtn);

            li.onclick = () => editSubNote(index);
            listEl.appendChild(li);
        });
    }

    function addSubNote() { const input = document.getElementById('newSubNoteInput'); if (input.value.trim() === '') return; const note = findNoteById(allData, currentNoteId); note.items.unshift(input.value.trim()); input.value = ''; saveData(); renderSubNotes(); }
    function deleteSubNote(index) { const note = findNoteById(allData, currentNoteId); note.items.splice(index, 1); saveData(); renderSubNotes(); }
    async function editSubNote(index) { const note = findNoteById(allData, currentNoteId); const newContent = await showInputModal('', note.items[index], 'area'); if (newContent !== null) { note.items[index] = newContent; saveData(); renderSubNotes(); } }
    function closeModalInternal() { document.getElementById('detailsModal').style.display = 'none'; document.getElementById('subSearchInput').value = ''; }

    // Context Menu
    function showContextMenu(id) { 
        activeCardId = id; const menu = document.getElementById('contextMenu'); menu.style.display = 'flex'; 
        menu.style.top = '50%'; menu.style.left = '50%';
        setTimeout(() => { const close = () => { menu.style.display='none'; document.removeEventListener('click', close); }; document.addEventListener('click', close); }, 100); 
    }
    
    async function handleMenuAction(action) {
        document.getElementById('contextMenu').style.display = 'none'; const item = findNoteById(allData, activeCardId); if (!item) return;
        
        if (action === 'delete') {
            if (item.isLocked && !(await checkPassword(item))) return;
            if (await showConfirmModal(`Ø­Ø°Ù "${item.title}" Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ`)) { 
                if (currentFolderId === null) allData = allData.filter(n => n.id !== activeCardId); 
                else findNoteById(allData, currentFolderId).items = findNoteById(allData, currentFolderId).items.filter(n => n.id !== activeCardId); 
                saveData(); renderMainGrid(); 
            }
        } else if (action === 'edit') {
            if (item.isLocked && !(await checkPassword(item))) return;
            const newTitle = await showInputModal('ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…:', item.title, 'single');
            if (newTitle) { item.title = newTitle; saveData(); renderMainGrid(); }
        } else if (action === 'toggleLock') {
            if (item.isLocked) { if (await checkPassword(item)) { item.isLocked = false; item.passwordHash = null; showNotification('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù‚ÙÙ„', 'success'); } } 
            else { const pass = await showPasswordModal(); if (pass) { item.isLocked = true; item.passwordHash = btoa(pass); showNotification('ØªÙ… Ø§Ù„Ù‚ÙÙ„', 'success'); } }
            saveData(); renderMainGrid();
        } else if (action === 'copyText') {
            if (item.isLocked && !(await checkPassword(item))) return;
            navigator.clipboard.writeText(item.items.join("\n\n")); showNotification('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù…Ø­ØªÙˆÙ‰', 'success');
        }
    }

    // Settings & Modal Logic
    function handleSettingsOpen() { 
        document.getElementById('settingsModal').style.display = 'flex'; 
        checkGoogleLoginState();
        updateLockText();
    }
    function hideSettingsModal() { document.getElementById('settingsModal').style.display = 'none'; }
    function updateLockText() {
        const hasPass = localStorage.getItem(APP_PASS_KEY);
        document.getElementById('lockText').innerText = hasPass ? 'Ø¥Ù„ØºØ§Ø¡ Ù‚ÙÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚' : 'Ù‚ÙÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (ÙƒÙˆØ¯)';
    }

    // *** FIX: Manual Export/Import with Auto Close ***
    function exportDataManual() { 
        hideSettingsModal(); 
        setTimeout(() => { showInputModal('Ø§Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©:', JSON.stringify(allData), 'area'); }, 100);
    }
    function importDataPaste() { 
        hideSettingsModal(); 
        setTimeout(async () => {
            const t = await showInputModal('Ø§Ù„ØµÙ‚ ÙƒÙˆØ¯ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©:', '', 'area');
            if(t) { try { allData = JSON.parse(t); saveData(); renderMainGrid(); showNotification('ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­', 'success'); } catch(e){ showNotification('ÙƒÙˆØ¯ ØºÙŠØ± ØµØ§Ù„Ø­', 'error'); } }
        }, 100);
    }
    function exportDataAuto() {
        const blob = new Blob([JSON.stringify(allData)], {type: "application/json"}); 
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); 
        a.download = "my_secret_notes.json"; a.click();
    }
    function importDataWrapper(e) {
        const reader = new FileReader(); 
        reader.onload = (f) => { try { allData = JSON.parse(f.target.result); saveData(); renderMainGrid(); hideSettingsModal(); showNotification('ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯', 'success'); } catch(e){} }; 
        reader.readAsText(e.target.files[0]);
    }
    async function deleteAllData() {
        hideSettingsModal();
        if(await showConfirmModal("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ÙƒÙ„ Ø´ÙŠØ¡ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹!")) {
            allData = []; saveData(); renderMainGrid(); showNotification("ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "success");
        }
    }

    // App Lock Logic
    async function setAppPassword() {
        const hasPass = localStorage.getItem(APP_PASS_KEY);
        if(hasPass) {
            // Remove Lock
             if(await showConfirmModal("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø²Ø§Ù„Ø© Ù‚ÙÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ØŸ")) {
                 const p = await showPasswordModal();
                 if(p && btoa(p) === hasPass) { localStorage.removeItem(APP_PASS_KEY); updateLockText(); showNotification("ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‚ÙÙ„", "success"); }
                 else { showNotification("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø·Ø£", "error"); }
             }
        } else {
            // Set Lock
            const p = await showPasswordModal();
            if(p) { localStorage.setItem(APP_PASS_KEY, btoa(p)); updateLockText(); showNotification("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù‚ÙÙ„", "success"); }
        }
    }

    // Helper Modals
    function showInputModal(msg, val = '', type = 'single') {
        pushState(); document.getElementById('inputMessage').innerText = msg; const modal = document.getElementById('inputModal');
        const s = document.getElementById('modalInputSingle'); const a = document.getElementById('modalInputArea');
        s.style.display = type==='single'?'block':'none'; a.style.display = type==='area'?'block':'none';
        const active = type==='single'?s:a; active.value = val; modal.style.display = 'flex'; active.focus();
        return new Promise(resolve => { 
            document.getElementById('inputBtn').onclick = () => { modal.style.display='none'; resolve(active.value); window.history.back(); };
            window.hideInputModal = (res) => { modal.style.display='none'; resolve(res ? active.value : null); };
        });
    }
    function showConfirmModal(msg) { 
        document.getElementById('confirmMessage').innerText = msg; document.getElementById('confirmModal').style.display = 'flex';
        return new Promise(resolve => { window.hideConfirmModal = (r) => { document.getElementById('confirmModal').style.display='none'; resolve(r); }; }); 
    }
    function showPasswordModal() { 
        document.getElementById('modalPasswordInput').value=''; document.getElementById('passwordModal').style.display = 'flex'; document.getElementById('modalPasswordInput').focus();
        return new Promise(resolve => { 
            document.getElementById('passwordBtn').onclick = () => { document.getElementById('passwordModal').style.display='none'; resolve(document.getElementById('modalPasswordInput').value); };
            window.hidePasswordModal = () => { document.getElementById('passwordModal').style.display='none'; resolve(null); };
        }); 
    }
    function checkPassword(item, cb) { 
        showPasswordModal().then(p => { if(p && btoa(p) === item.passwordHash) cb(); else if(p) showNotification("Ø®Ø·Ø£ ÙÙŠ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", "error"); }); 
    }

    function showCreateMenu() { document.getElementById('createTypeMenu').style.display='flex'; setTimeout(()=> { document.addEventListener('click', function c(e){ if(!e.target.closest('#createTypeMenu') && !e.target.closest('.fab')) { document.getElementById('createTypeMenu').style.display='none'; document.removeEventListener('click', c); } }); }, 100); }
    function createItemWrapper(type) { 
        document.getElementById('createTypeMenu').style.display='none';
        showInputModal(type==='folder'?'Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ù„Ø¯':'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©').then(title => {
            if(title) { 
                const item = { id: Date.now(), type, title, items: [], isLocked: false }; 
                getCurrentList().unshift(item); saveData(); renderMainGrid(); 
            }
        });
    }

    function showNotification(m, t) { document.getElementById('notifIcon').innerText = t==='success'?'âœ…':'âŒ'; document.getElementById('notificationMessage').innerText=m; document.getElementById('notificationModal').style.display='flex'; }
    function closeNotification() { document.getElementById('notificationModal').style.display='none'; }

    // Google Drive Sync
    function initGoogleLib() {
        if(window.google) {
            tokenClient = google.accounts.oauth2.initTokenClient({ client_id: GOOGLE_CLIENT_ID, scope: SCOPES, callback: (r) => { if (r.access_token) { gAccessToken = r.access_token; localStorage.setItem('gAccessToken', gAccessToken); document.getElementById('loginOverlay').style.display = 'none'; showNotification("ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­", "success"); checkGoogleLoginState(); loadData(); } } });
            if(gAccessToken) { checkGoogleLoginState(); loadData(); } else { document.getElementById('loginOverlay').style.display = 'flex'; }
        }
    }
    function startGoogleLogin() { if(tokenClient) tokenClient.requestAccessToken(); }
    function openLoginOverlay() { hideSettingsModal(); document.getElementById('loginOverlay').style.display = 'flex'; }
    function checkGoogleLoginState() { 
        const loggedIn = !!gAccessToken;
        document.getElementById('googleLoginItem').style.display = loggedIn ? 'none' : 'flex';
        document.getElementById('googleLogoutItem').style.display = loggedIn ? 'flex' : 'none';
    }
    async function handleGoogleLogout() {
        hideSettingsModal();
        if(await showConfirmModal("ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø³ÙŠØ®ÙÙŠ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª (ØªØ¨Ù‚Ù‰ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©).")) {
            localStorage.removeItem('gAccessToken'); gAccessToken = null; allData = []; 
            renderMainGrid(); document.getElementById('loginOverlay').style.display = 'flex';
        }
    }
    function setSyncLoader(show) { document.getElementById('syncLoader').style.display = show ? 'inline-block' : 'none'; }
    async function forceUploadToDrive(silent) {
        if(!gAccessToken) return;
        try { const q = `name = '${FILENAME}' and 'appDataFolder' in parents and trashed = false`; const search = await fetch(`https://www.googleapis.com/drive/v3/files?q=${q}&spaces=appDataFolder`, { headers: { 'Authorization': `Bearer ${gAccessToken}` } }); 
        if(search.status === 401) { localStorage.removeItem('gAccessToken'); location.reload(); return; }
        const d = await search.json(); const blob = new Blob([JSON.stringify({smartNotesData: allData})], {type:'application/json'});
        if(d.files.length > 0) { await fetch(`https://www.googleapis.com/upload/drive/v3/files/${d.files[0].id}?uploadType=media`, { method: 'PATCH', headers: { 'Authorization': `Bearer ${gAccessToken}` }, body: blob }); }
        else { const meta = { name: FILENAME, parents: ['appDataFolder'] }; const form = new FormData(); form.append('metadata', new Blob([JSON.stringify(meta)], {type:'application/json'})); form.append('file', blob); await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', { method: 'POST', headers: { 'Authorization': `Bearer ${gAccessToken}` }, body: form }); }
        setSyncLoader(false); document.getElementById('syncText').innerText = ""; if(!silent) showNotification("ØªÙ… Ø§Ù„Ø­ÙØ¸", "success"); } catch(e){ setSyncLoader(false); }
    }
    async function forceSyncFromCloud(silent) {
        if(!gAccessToken) return; setSyncLoader(true); document.getElementById('syncText').innerText = "Ù…Ø²Ø§Ù…Ù†Ø©...";
        try { const q = `name = '${FILENAME}' and 'appDataFolder' in parents and trashed = false`; const search = await fetch(`https://www.googleapis.com/drive/v3/files?q=${q}&spaces=appDataFolder`, { headers: { 'Authorization': `Bearer ${gAccessToken}` } }); const d = await search.json();
        if(d.files.length > 0) { const f = await fetch(`https://www.googleapis.com/drive/v3/files/${d.files[0].id}?alt=media`, { headers: { 'Authorization': `Bearer ${gAccessToken}` } }); const json = await f.json(); if(json.smartNotesData) { allData = json.smartNotesData; renderMainGrid(); if(!silent) showNotification("ØªÙ…Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©", "success"); } }
        setSyncLoader(false); document.getElementById('syncText').innerText = ""; } catch(e){ setSyncLoader(false); }
    }
</script>  
</body>  
</html>